import{S as z,i as Q,s as K,C as te,E as ne,F as oe,G as ie,g as F,d as H,P as se,o as le,e as x,b as C,f as re,h as E,H as ae,v as ce,k as g,a as I,y as W,l as m,m as G,c as B,z as X,n as M,p as Z,D as i,A as $,B as ee,q as j,r as q,I as ue,L as fe,Q as de}from"../chunks/index.7d0cd1aa.js";import{N as ge}from"../chunks/Navbar.b34abe71.js";import{p as me}from"../chunks/stores.37722b3e.js";import{u as J,a as V}from"../chunks/auth.c1f5eb36.js";import{g as he}from"../chunks/navigation.88d3dd4c.js";const _e=async(c,t)=>{let n=document.getElementById(t);return n||(n=document.createElement("script"),n.id=t,n.src=c,document.body.appendChild(n)),new Promise((o,s)=>{n.onload=()=>o(),n.onerror=r=>{document.body.removeChild(n),s(r)}})},be=c=>{const t=document.getElementById(c);t&&t.parentNode.removeChild(t)},ye=c=>({disabled:c&1}),Y=c=>({signIn:c[1],disabled:!c[0]});function pe(c){let t;const n=c[18].default,o=te(n,c,c[17],Y);return{c(){o&&o.c()},l(s){o&&o.l(s)},m(s,r){o&&o.m(s,r),t=!0},p(s,[r]){o&&o.p&&(!t||r&131073)&&ne(o,n,s,s[17],t?ie(n,s[17],r,ye):oe(s[17]),Y)},i(s){t||(F(o,s),t=!0)},o(s){H(o,s),t=!1},d(s){o&&o.d(s)}}}function Ie(c,t,n){let{$$slots:o={},$$scope:s}=t,{clientId:r}=t,{scope:u="profile email"}=t,{redirectUri:S=void 0}=t,{cookiePolicy:l="single_host_origin"}=t,{loginHint:h=void 0}=t,{hostedDomain:f=void 0}=t,{prompt:P=""}=t,{responseType:_=void 0}=t,{autoLoad:p=void 0}=t,{uxMode:b="popup"}=t,{fetchBasicProfile:N=!0}=t,{isSignedIn:R=!1}=t,{discoveryDocs:T=void 0}=t,{accessType:U="online"}=t,{script:L="https://apis.google.com/js/api.js"}=t;const y=se();let v=!1;const O=e=>{const d=e.getBasicProfile(),w=e.getAuthResponse(!0);e.googleId=d.getId(),e.tokenObj=w,e.accessToken=w.access_token,e.profileObj={googleId:d.getId(),imageUrl:d.getImageUrl(),email:d.getEmail(),name:d.getName(),givenName:d.getGivenName(),familyName:d.getFamilyName()},y("success",e)},D=e=>{if(e&&e.preventDefault(),v){const d=window.gapi.auth2.getAuthInstance(),w={prompt:P};y("request"),_==="code"?d.grantOfflineAccess(w).then(k=>y("success",k),k=>y("failure",k)):d.signIn(w).then(k=>O(k),k=>y("failure",k))}};le(()=>{let e=!1;return _e(L,"google-login").then(()=>{const d={client_id:r,cookie_policy:l,login_hint:h,hosted_domain:f,fetch_basic_profile:N,discoveryDocs:T,ux_mode:b,redirect_uri:S,scope:u,access_type:U};_==="code"&&(d.access_type="offline"),window.gapi.load("auth2",()=>{const w=window.gapi.auth2.getAuthInstance();w?w.then(()=>{e||(R&&w.isSignedIn.get()?(n(0,v=!0),y("autoLoadFinished",!0),O(w.currentUser.get())):(n(0,v=!0),y("autoLoadFinished",!1)))},k=>y("failure",k)):window.gapi.auth2.init(d).then(k=>{if(!e){n(0,v=!0);const A=R&&k.isSignedIn.get();y("autoLoadFinished",A),A&&O(k.currentUser.get())}},k=>{n(0,v=!0),y("autoLoadFinished",!1),y("failure",k)})})}).catch(d=>y("failure",d)),()=>{e=!0,be("google-login")}});const a=e=>{p&&D()};return c.$$set=e=>{"clientId"in e&&n(2,r=e.clientId),"scope"in e&&n(3,u=e.scope),"redirectUri"in e&&n(4,S=e.redirectUri),"cookiePolicy"in e&&n(5,l=e.cookiePolicy),"loginHint"in e&&n(6,h=e.loginHint),"hostedDomain"in e&&n(7,f=e.hostedDomain),"prompt"in e&&n(8,P=e.prompt),"responseType"in e&&n(9,_=e.responseType),"autoLoad"in e&&n(10,p=e.autoLoad),"uxMode"in e&&n(11,b=e.uxMode),"fetchBasicProfile"in e&&n(12,N=e.fetchBasicProfile),"isSignedIn"in e&&n(13,R=e.isSignedIn),"discoveryDocs"in e&&n(14,T=e.discoveryDocs),"accessType"in e&&n(15,U=e.accessType),"script"in e&&n(16,L=e.script),"$$scope"in e&&n(17,s=e.$$scope)},c.$$.update=()=>{c.$$.dirty&1&&a()},[v,D,r,u,S,l,h,f,P,_,p,b,N,R,T,U,L,s,o]}class Be extends z{constructor(t){super(),Q(this,t,Ie,pe,K,{clientId:2,scope:3,redirectUri:4,cookiePolicy:5,loginHint:6,hostedDomain:7,prompt:8,responseType:9,autoLoad:10,uxMode:11,fetchBasicProfile:12,isSignedIn:13,discoveryDocs:14,accessType:15,script:16})}}function ke(c){let t,n,o,s,r,u,S,l,h,f,P,_,p,b,N,R,T,U,L,y,v,O,D;return b=new Be({props:{clientId:"430888155183-p0e7c7m7qsbpt5p141chqpbk3491n04t.apps.googleusercontent.com",$$slots:{default:[Pe,({signIn:a})=>({7:a}),({signIn:a})=>a?128:0]},$$scope:{ctx:c}}}),b.$on("success",c[1]),b.$on("failure",c[2]),{c(){t=g("div"),n=g("br"),o=I(),s=g("br"),r=I(),u=g("br"),S=I(),l=g("br"),h=I(),f=g("br"),P=I(),_=g("br"),p=I(),W(b.$$.fragment),N=I(),R=g("br"),T=I(),U=g("br"),L=I(),y=g("br"),v=I(),O=g("br"),this.h()},l(a){t=m(a,"DIV",{class:!0,style:!0});var e=G(t);n=m(e,"BR",{}),o=B(e),s=m(e,"BR",{}),r=B(e),u=m(e,"BR",{}),S=B(e),l=m(e,"BR",{}),h=B(e),f=m(e,"BR",{}),P=B(e),_=m(e,"BR",{}),p=B(e),X(b.$$.fragment,e),N=B(e),R=m(e,"BR",{}),T=B(e),U=m(e,"BR",{}),L=B(e),y=m(e,"BR",{}),v=B(e),O=m(e,"BR",{}),e.forEach(E),this.h()},h(){M(t,"class","container section text-center"),Z(t,"min-height","80vh")},m(a,e){C(a,t,e),i(t,n),i(t,o),i(t,s),i(t,r),i(t,u),i(t,S),i(t,l),i(t,h),i(t,f),i(t,P),i(t,_),i(t,p),$(b,t,null),i(t,N),i(t,R),i(t,T),i(t,U),i(t,L),i(t,y),i(t,v),i(t,O),D=!0},p(a,e){const d={};e&384&&(d.$$scope={dirty:e,ctx:a}),b.$set(d)},i(a){D||(F(b.$$.fragment,a),D=!0)},o(a){H(b.$$.fragment,a),D=!1},d(a){a&&E(t),ee(b)}}}function Se(c){let t,n,o,s,r,u,S,l,h,f,P,_,p,b,N,R,T,U,L,y,v,O,D;return t=new ge({}),{c(){W(t.$$.fragment),n=I(),o=g("div"),s=g("br"),r=I(),u=g("br"),S=I(),l=g("div"),h=g("h4"),f=j("You are logged In"),P=I(),_=g("button"),p=g("a"),b=j("Go to Home Page"),N=I(),R=g("br"),T=I(),U=g("br"),L=I(),y=g("br"),v=I(),O=g("br"),this.h()},l(a){X(t.$$.fragment,a),n=B(a),o=m(a,"DIV",{class:!0,style:!0});var e=G(o);s=m(e,"BR",{}),r=B(e),u=m(e,"BR",{}),S=B(e),l=m(e,"DIV",{class:!0});var d=G(l);h=m(d,"H4",{});var w=G(h);f=q(w,"You are logged In"),w.forEach(E),P=B(d),_=m(d,"BUTTON",{});var k=G(_);p=m(k,"A",{href:!0});var A=G(p);b=q(A,"Go to Home Page"),A.forEach(E),k.forEach(E),d.forEach(E),N=B(e),R=m(e,"BR",{}),T=B(e),U=m(e,"BR",{}),L=B(e),y=m(e,"BR",{}),v=B(e),O=m(e,"BR",{}),e.forEach(E),this.h()},h(){M(p,"href","/"),M(l,"class","text-center"),M(o,"class","section"),Z(o,"min-height","80vh")},m(a,e){$(t,a,e),C(a,n,e),C(a,o,e),i(o,s),i(o,r),i(o,u),i(o,S),i(o,l),i(l,h),i(h,f),i(l,P),i(l,_),i(_,p),i(p,b),i(o,N),i(o,R),i(o,T),i(o,U),i(o,L),i(o,y),i(o,v),i(o,O),D=!0},p:ue,i(a){D||(F(t.$$.fragment,a),D=!0)},o(a){H(t.$$.fragment,a),D=!1},d(a){ee(t,a),a&&E(n),a&&E(o)}}}function Pe(c){let t,n,o,s;return{c(){t=g("button"),n=j("Sign in with Google")},l(r){t=m(r,"BUTTON",{});var u=G(t);n=q(u,"Sign in with Google"),u.forEach(E)},m(r,u){C(r,t,u),i(t,n),o||(s=fe(t,"click",function(){de(c[7])&&c[7].apply(this,arguments)}),o=!0)},p(r,u){c=r},d(r){r&&E(t),o=!1,s()}}}function Re(c){let t,n,o,s;const r=[Se,ke],u=[];function S(l,h){return l[0]?0:1}return t=S(c),n=u[t]=r[t](c),{c(){n.c(),o=x()},l(l){n.l(l),o=x()},m(l,h){u[t].m(l,h),C(l,o,h),s=!0},p(l,[h]){let f=t;t=S(l),t===f?u[t].p(l,h):(ce(),H(u[f],1,1,()=>{u[f]=null}),re(),n=u[t],n?n.p(l,h):(n=u[t]=r[t](l),n.c()),F(n,1),n.m(o.parentNode,o))},i(l){s||(F(n),s=!0)},o(l){H(n),s=!1},d(l){u[t].d(l),l&&E(o)}}}function ve(c,t,n){let o;ae(c,me,f=>n(4,o=f));const s=o.url.searchParams.get("nextPage");let r;J.subscribe(f=>{f?n(0,r=JSON.parse(f)):n(0,r=null)});let u=null;const S=f=>{u=f.detail.profileObj,console.log("User signed in successfully");let P=u.givenName,_=u.familyName,p=u.email;console.log(u);let b=(Math.random()+1).toString(36).substring(7);V("https://codingchaska.up.railway.app/api/v1/auth/users/",{password:b,firstname:P,lastname:_,email:p},"POST").then(R=>{l(p)}).catch(R=>{l(p),console.log(R)})},l=f=>{V("https://codingchaska.up.railway.app/api/v1/auth/get-user-email/",{email:f}).then(_=>{localStorage.setItem("user",JSON.stringify(_)),J.set(JSON.stringify(_)),s&&he(s)}).catch(_=>{console.log(_)})};return[r,S,f=>{const P=f.detail;console.error("Error while signing in: ",P)}]}class Ue extends z{constructor(t){super(),Q(this,t,ve,Re,K,{})}}export{Ue as default};
